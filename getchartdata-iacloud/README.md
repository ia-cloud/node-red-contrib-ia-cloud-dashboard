# node-red-contrib-ia-cloud-dashboard - getchartdata-iacloud

## 名称
getChartdataノード



## 機能概要

このノードは指定したDynamoDBからiacloudオブジェクトを取得・アグリゲーション処理を行い、dashborad - chartへ入力する際の形へ変換することができます。

AWS-SDK DynamoDB関数をラップしており、DynamoDBからデータを取得する処理にはQueryを使用しています。  
より詳細に知るには、[APIドキュメント](https://docs.aws.amazon.com/sdkforruby/api/Aws/DynamoDB/Client.html)を参照してください。

このノードを使用するには、DynamoDB操作ユーザの情報が必要になります。  
ユーザ情報は別途発行・取得する必要があります。  
 


## プロパティー

取得するデータに応じて以下のパラメータを設定します。  

- ### 名前
  フロー上で表示するノード名を設定します。

- ### ユーザID
  使用するDynamoDB操作ユーザのIDを設定します。

- ### パスワード
  使用するDynamoDB操作ユーザのパスワードを設定します。

- ### テーブル名
  検索を行うテーブル名を設定します。

- ### オブジェクトキー  
  検索を行うデータのobjectKeyを設定します。

- ### 項目設定  
  出力結果のdataName部分の表示名を変更することができます。  
  対応するdataNameと出力したい表示名を入力します。   
  表示名が未入力の場合は、dataNameをそのまま出力します。  

- ### 期間  
  「ノード：[ui-dateset-iacloud](https://github.com/ia-cloud/node-red-contrib-ia-cloud-dashboard/tree/master/ui-dateset)」からの入力により期間設定を行いたい場合は、「dateasetからの入力を許可する」を選択します。  
  本ノード内で期間設定を行いたい場合は、手動設定を選択して取得開始日時と終了日時を記述してください。    
  未入力の場合、全期間が検索対象になります。  

- ### 繰り返し  
  繰り返し処理を行う場合は本項目を設定します。  
  設定後、繰り返し間隔を設定します。  

- ### アグリゲーション
  取得データのアグリゲーションが可能です。  
  アグリゲーション処理を行う場合は設定にチェックを入れ、行うアグリゲーション処理、期間単位、表示桁数を指定します。  
  各項目に設定できるものは以下の通りです。  
   - アグリゲーション処理  
  　最大値、最小値、平均、中央値、カウント、最初、最後  
   - 期間単位  
  　年、月、日、時、分、秒  

- ### 表示桁数
  取得データの表示桁数の設定をします。  
  小数第3位～100の位、丸めなしの設定が可能です。

- ### データ件数   
  出力する結果件数を設定します。  
  未設定だった場合、最大10,000件を出力します。  

- ### 並び順  
  検索結果の並び順(昇順/降順)を設定します。  
  アグリゲーション処理が設定されている場合、並び順を指定することはできません。  



## 出力メッセージ
取得したiacloudオブジェクトをdashborad - chartへ入力する際の形に変換した結果が出力されます。  
以下に例を示します。

         [
            {
                "series": [
                    "電流1ch"
                ],
                "data": [
                    [
                        {
                            "x": "2019-04-01T13:01:00+09:00",
                            "y": 0.24
                        },
                        {
                            "x": "2019-04-01T13:02:00+09:00",
                            "y": 0.3
                        },
                        {
                            "x": "2019-04-01T13:03:00+09:00",
                            "y": 0.25
                        },
                        {
                            "x": "2019-04-01T13:04:00+09:00",
                            "y": 0.26
                        },
                        {
                            "x": "2019-04-01T13:05:00+09:00",
                            "y": 0.25
                        }
                    ]
                ],
                "labels": [
                    ""
                ]
            }
        ]

